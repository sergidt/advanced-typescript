<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Maybe monad - example without monad</title>
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Roboto:300,300italic,700,700italic">
    <link rel="stylesheet" href="styles/milligram.css">
    <link rel="stylesheet" href="styles/prism.css" />
    <link rel="stylesheet" href="styles/styles.css" />
</head>
<body>
<a href="index.html" class="float-right">Back to main section</a>

<h3>Find employee's supervisor</h3>
<p>
    <label for="findEmployeeButton">Enter employee ID</label>
    <input type="text" name="employeeId" id="employeeIdInput"  />
</p>
<p>
    <button type="button" id="findEmployeeButton">Find supervisor's name</button>
</p>
<p id="searchResults"></p>

<hr>

<h3>Code</h3>

<pre><code class="language-ts">
interface Employee {
    id: number;
    name: string;
    supervisorId?: number;
}

class EmployeeRepository {
    private employees: Employee[] = [
        { id: 1, name: "John" },
        { id: 2, name: "Jane", supervisorId: 1 },
        { id: 3, name: "Joe", supervisorId: 2 },
    ];

    findById(id: number) {
        const results = this.employees.filter(employee => employee.id === id);
        return results.length ? results[0] : null;
    }
}

const employeeIdInputEl = document.getElementById("employeeIdInput") as HTMLInputElement;
const findEmployeeButtonEl = document.getElementById("findEmployeeButton");
const searchResultsEl = document.getElementById("searchResults");

const repository = new EmployeeRepository();

findEmployeeButtonEl.addEventListener("click", () => {
    const supervisorName = getSupervisorName(employeeIdInputEl.value);
    if (supervisorName) {
        searchResultsEl.innerText = `Supervisor name: ${supervisorName}`;
    } else {
        searchResultsEl.innerText = "Could not find supervisor for given id";
    }
});

function getSupervisorName(enteredId: string) {
    if (enteredId) {
        const employee = repository.findById(parseInt(enteredId));
        if (employee && employee.supervisorId) {
            const supervisor = repository.findById(employee.supervisorId);
            if (supervisor) {
                return supervisor.name;
            }
        }
    }
}
</code></pre>

<h3>Problems with the getSupervisorName function</h3>

The function body involves several levels of nesting. This is because many things can go wrong during the search for the supervisor.

<ul>
    <li>the user can click the button without typing anything in the ID field</li>
    <li>there can be no employee for given ID</li>
    <li>the employee we’re looking for can have no supervisor (e.g. they’re a CEO or an independent consultant)</li>
    <li>there can be no employee with ID equal to the employee’s supervisor’s ID (inconsistency in the hierarchy)</li>
</ul>
<script src="styles/prism.js"></script>
<script src="no-maybe-monad.js"></script>
</body>
</html>